<!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>スライドプレゼンテーション</title>
        <style>
            body {
                font-family: 'Arial', sans-serif;
                margin: 0;
                padding: 0;
                background-color: #f5f5f5;
                color: #333;
                display: flex;
                flex-direction: column;
                height: 100vh;
            }
            
            .slides-container {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                position: relative;
                overflow: hidden;
            }
            
            .slide {
                display: none;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                width: 100%;
                height: 100%;
                padding: 20px;
                box-sizing: border-box;
            }
            
            .slide.active {
                display: flex;
                animation: fadeIn 0.5s;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            
            .slide-title {
                font-size: 24px;
                margin-bottom: 20px;
                text-align: center;
            }
            
            .slide-image {
                max-width: 90%;
                max-height: 70vh;
                object-fit: contain;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }
            
            .controls {
                background-color: #333;
                color: white;
                display: flex;
                padding: 15px;
                justify-content: center;
                align-items: center;
                gap: 20px;
            }
            
            .control-btn {
                background-color: #4CAF50;
                border: none;
                color: white;
                padding: 8px 16px;
                text-align: center;
                text-decoration: none;
                font-size: 16px;
                cursor: pointer;
                border-radius: 4px;
                transition: background-color 0.2s;
            }
            
            .control-btn:hover {
                background-color: #45a049;
            }
            
            .control-btn:disabled {
                background-color: #cccccc;
                cursor: not-allowed;
            }
            
            .slide-indicator {
                font-size: 16px;
            }
            
            /* 音声プレーヤーのスタイル */
            .audio-container {
                margin-top: 15px;
                width: 80%;
                max-width: 500px;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            
            audio {
                width: 100%;
            }
            
            /* ローディングインジケータ */
            #loading {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(255, 255, 255, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
            }
            
            .spinner {
                width: 50px;
                height: 50px;
                border: 5px solid #f3f3f3;
                border-top: 5px solid #3498db;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }
            
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            /* 速度コントロールのスタイル */
            .speed-controls {
                display: flex;
                gap: 10px;
                margin-top: 5px;
                align-items: center;
            }
            
            .speed-btn {
                background-color: #3498db;
                border: none;
                color: white;
                padding: 4px 8px;
                text-align: center;
                font-size: 14px;
                cursor: pointer;
                border-radius: 4px;
            }
            
            .speed-btn:hover {
                background-color: #2980b9;
            }
            
            .speed-btn.active {
                background-color: #e74c3c;
                font-weight: bold;
            }
            
            .speed-label {
                font-size: 14px;
                white-space: nowrap;
            }
        </style>
    </head>
    <body>
        <!-- ローディング表示 -->
        <div id="loading">
            <div class="spinner"></div>
        </div>
        
        <div class="slides-container" id="slidesContainer">
            
            <div class="slide" id="slide1">
                <h2 class="slide-title">①導入</h2>
                <img class="slide-image" src="images/slide_1.png" alt="スライド 1">
                
                
                <div class="audio-container">
                    <audio id="audio1" controls preload="none">
                        <source src="audio/audio_1.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
            <div class="slide" id="slide2">
                <h2 class="slide-title">②現状課題</h2>
                <img class="slide-image" src="images/slide_2.png" alt="スライド 2">
                
                
                <div class="audio-container">
                    <audio id="audio2" controls preload="none">
                        <source src="audio/audio_2.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
            <div class="slide" id="slide3">
                <h2 class="slide-title">③Salesforce導入コンセプト</h2>
                <img class="slide-image" src="images/slide_3.png" alt="スライド 3">
                
                
                <div class="audio-container">
                    <audio id="audio3" controls preload="none">
                        <source src="audio/audio_3.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
            <div class="slide" id="slide4">
                <h2 class="slide-title">重複チェック</h2>
                <img class="slide-image" src="images/slide_4.png" alt="スライド 4">
                
                
                <div class="audio-container">
                    <audio id="audio4" controls preload="none">
                        <source src="audio/audio_4.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
            <div class="slide" id="slide5">
                <h2 class="slide-title">レポート</h2>
                <img class="slide-image" src="images/slide_5.png" alt="スライド 5">
                
                
                <div class="audio-container">
                    <audio id="audio5" controls preload="none">
                        <source src="audio/audio_5.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
            <div class="slide" id="slide6">
                <h2 class="slide-title">⑥まとめと未来像</h2>
                <img class="slide-image" src="images/slide_6.png" alt="スライド 6">
                
                
                <div class="audio-container">
                    <audio id="audio6" controls preload="none">
                        <source src="audio/audio_6.wav" type="audio/wav">
                        お使いのブラウザは音声プレーヤーをサポートしていません。
                    </audio>
                </div>
                
            </div>
            
        </div>
        
        <div class="controls">
            <button id="prevBtn" class="control-btn">前へ</button>
            <span class="slide-indicator" id="slideIndicator">1 / 6</span>
            <button id="nextBtn" class="control-btn">次へ</button>
            <button id="playBtn" class="control-btn">音声再生</button>
            <button id="autoplayBtn" class="control-btn">自動再生</button>
            <!-- 速度コントロールボタンを追加 -->
            <span class="speed-label">速度:</span>
            <button id="speedDown" class="speed-btn">-</button>
            <span id="speedValue">1.0x</span>
            <button id="speedUp" class="speed-btn">+</button>
        </div>
        
        <script>
            // スライドの制御
            let currentSlide = 1;
            const totalSlides = 6;
            let autoplayMode = false;
            let autoplayTimer = null;
            // 音声速度を保持する変数
            let currentPlaybackRate = 1.0;
            // 利用可能な速度設定
            const speedOptions = [0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0];
            let currentSpeedIndex = 2; // 1.0x がデフォルト
            
            // 画像読み込み完了時にローディング表示を消す
            window.onload = function() {
                document.getElementById('loading').style.display = 'none';
                
                // 初期表示
                document.getElementById('slide1').classList.add('active');
                updateButtons();
                
                // 初期速度を設定
                updateAllAudioSpeeds();
            };
            
            // イベントリスナー
            document.getElementById('prevBtn').addEventListener('click', showPreviousSlide);
            document.getElementById('nextBtn').addEventListener('click', showNextSlide);
            document.getElementById('playBtn').addEventListener('click', toggleAudio);
            document.getElementById('autoplayBtn').addEventListener('click', toggleAutoplay);
            document.getElementById('speedDown').addEventListener('click', decreaseSpeed);
            document.getElementById('speedUp').addEventListener('click', increaseSpeed);
            
            // 速度を下げる
            function decreaseSpeed() {
                if (currentSpeedIndex > 0) {
                    currentSpeedIndex--;
                    updatePlaybackRate();
                }
            }
            
            // 速度を上げる
            function increaseSpeed() {
                if (currentSpeedIndex < speedOptions.length - 1) {
                    currentSpeedIndex++;
                    updatePlaybackRate();
                }
            }
            
            // 再生速度を更新
            function updatePlaybackRate() {
                currentPlaybackRate = speedOptions[currentSpeedIndex];
                document.getElementById('speedValue').textContent = currentPlaybackRate.toFixed(2) + 'x';
                updateAllAudioSpeeds();
            }
            
            // すべての音声要素の速度を更新
            function updateAllAudioSpeeds() {
                for (let i = 1; i <= totalSlides; i++) {
                    const audio = document.getElementById('audio' + i);
                    if (audio) {
                        audio.playbackRate = currentPlaybackRate;
                    }
                }
            }
            
            // 前のスライドを表示
            function showPreviousSlide() {
                if (currentSlide > 1) {
                    stopCurrentAudio();
                    document.getElementById('slide' + currentSlide).classList.remove('active');
                    currentSlide--;
                    document.getElementById('slide' + currentSlide).classList.add('active');
                    updateButtons();
                    
                    if (autoplayMode) {
                        playCurrentAudio();
                    }
                }
            }
            
            // 次のスライドを表示
            function showNextSlide() {
                if (currentSlide < totalSlides) {
                    stopCurrentAudio();
                    document.getElementById('slide' + currentSlide).classList.remove('active');
                    currentSlide++;
                    document.getElementById('slide' + currentSlide).classList.add('active');
                    updateButtons();
                    
                    if (autoplayMode) {
                        playCurrentAudio();
                    }
                } else if (autoplayMode) {
                    // 自動再生モードで最後のスライドに到達した場合
                    toggleAutoplay(); // 自動再生を停止
                }
            }
            
            // 現在のスライドの音声を再生
            function playCurrentAudio() {
                const audio = document.getElementById('audio' + currentSlide);
                if (audio) {
                    // 速度を設定
                    audio.playbackRate = currentPlaybackRate;
                    
                    const playPromise = audio.play();
                    
                    if (playPromise !== undefined) {
                        playPromise.then(_ => {
                            // 自動再生成功
                            document.getElementById('playBtn').textContent = '音声停止';
                            
                            // 自動再生モードの場合、音声終了後に次のスライドへ
                            if (autoplayMode) {
                                audio.onended = function() {
                                    setTimeout(showNextSlide, 1000); // 1秒後に次のスライドへ
                                };
                            }
                        }).catch(error => {
                            // 自動再生失敗
                            console.log("音声の自動再生ができませんでした。ユーザー操作が必要です。", error);
                        });
                    }
                }
            }
            
            // 現在のスライドの音声を再生/停止
            function toggleAudio() {
                const audio = document.getElementById('audio' + currentSlide);
                if (audio) {
                    if (audio.paused) {
                        playCurrentAudio();
                    } else {
                        audio.pause();
                        document.getElementById('playBtn').textContent = '音声再生';
                    }
                }
            }
            
            // 現在の音声を停止
            function stopCurrentAudio() {
                const audio = document.getElementById('audio' + currentSlide);
                if (audio && !audio.paused) {
                    audio.pause();
                    audio.currentTime = 0;
                    document.getElementById('playBtn').textContent = '音声再生';
                }
            }
            
            // 自動再生モードの切り替え
            function toggleAutoplay() {
                autoplayMode = !autoplayMode;
                
                if (autoplayMode) {
                    document.getElementById('autoplayBtn').textContent = '自動再生停止';
                    document.getElementById('autoplayBtn').style.backgroundColor = '#e74c3c';
                    playCurrentAudio(); // 現在のスライドから自動再生開始
                } else {
                    document.getElementById('autoplayBtn').textContent = '自動再生';
                    document.getElementById('autoplayBtn').style.backgroundColor = '#4CAF50';
                    // 音声は再生したままにして、次のスライドへの自動移動を停止
                    const audio = document.getElementById('audio' + currentSlide);
                    if (audio) {
                        audio.onended = null;
                    }
                }
            }
            
            // ボタン状態の更新
            function updateButtons() {
                document.getElementById('prevBtn').disabled = (currentSlide === 1);
                document.getElementById('nextBtn').disabled = (currentSlide === totalSlides);
                document.getElementById('slideIndicator').textContent = `${currentSlide} / ${totalSlides}`;
                
                // 現在のスライドに音声があるかチェック
                const audio = document.getElementById('audio' + currentSlide);
                if (audio) {
                    document.getElementById('playBtn').disabled = false;
                    document.getElementById('playBtn').textContent = audio.paused ? '音声再生' : '音声停止';
                } else {
                    document.getElementById('playBtn').disabled = true;
                }
            }
            
            // キーボードナビゲーション
            document.addEventListener('keydown', function(event) {
                if (event.key === 'ArrowLeft') {
                    showPreviousSlide();
                } else if (event.key === 'ArrowRight') {
                    showNextSlide();
                } else if (event.key === ' ' || event.key === 'Spacebar') {
                    toggleAudio();
                    event.preventDefault(); // スペースキーのスクロールを防止
                } else if (event.key === 'ArrowUp') {
                    increaseSpeed(); // 上矢印キーで速度アップ
                    event.preventDefault();
                } else if (event.key === 'ArrowDown') {
                    decreaseSpeed(); // 下矢印キーで速度ダウン
                    event.preventDefault();
                }
            });
        </script>
    </body>
    </html>
